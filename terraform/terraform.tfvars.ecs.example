# =============================================================================
# AWS ECS Fargate Configuration Example
# Copy this file to terraform.tfvars and customize for your deployment
# =============================================================================

# Basic AWS Configuration
aws_region  = "us-east-1"
environment = "prod"

# S3 Storage (required - must be globally unique!)
bucket_name = "your-unique-bucket-name"  # CHANGE THIS!

# =============================================================================
# ECS Configuration
# =============================================================================

# Cluster and Service Names
ecs_cluster_name    = "bad-apples-cluster"
ecs_service_name    = "bad-apples-backend-service"
ecs_task_family     = "bad-apples-backend-task"
ecr_repository_name = "bad-apples-backend"
container_name      = "bad-apples-backend"

# Container Configuration
container_port = 8000

# =============================================================================
# Resource Sizing
# =============================================================================

# Task Resources (CPU and Memory)
# CPU values: 256, 512, 1024, 2048, 4096
# Memory values: 512-30720 (must be compatible with CPU)
ecs_task_cpu    = 1024  # 1 vCPU (recommended for FastAPI with Uvicorn)
ecs_task_memory = 2048  # 2 GB RAM

# Auto-scaling Configuration
ecs_desired_count = 1  # Initial number of tasks
ecs_min_capacity  = 1  # Minimum tasks (for cost savings)
ecs_max_capacity  = 4  # Maximum tasks (for handling traffic spikes)

# Auto-scaling Triggers (percentage)
autoscaling_target_cpu    = 70  # Scale up when CPU > 70%
autoscaling_target_memory = 80  # Scale up when memory > 80%

# =============================================================================
# Health Check Configuration
# =============================================================================

health_check_path               = "/health"
health_check_interval           = 30
health_check_timeout            = 5
health_check_healthy_threshold   = 2
health_check_unhealthy_threshold = 3
deregistration_delay            = 30

# =============================================================================
# Logging and Monitoring
# =============================================================================

log_retention_days = 7  # CloudWatch log retention (1, 3, 5, 7, 14, 30, 60, 90...)
enable_ecs_exec    = false  # Enable for debugging (allows shell access to containers)
enable_monitoring  = false  # Enable CloudWatch detailed monitoring

# =============================================================================
# Network Configuration
# =============================================================================

create_vpc = true  # Create new VPC (recommended)
vpc_cidr   = "10.0.0.0/16"

# =============================================================================
# Load Balancer Configuration
# =============================================================================

alb_idle_timeout           = 60    # ALB timeout in seconds
enable_deletion_protection = false # Protect ALB from accidental deletion (enable for prod)

# HTTPS Configuration (optional)
enable_https    = false # Set to true if you have an ACM certificate
certificate_arn = ""    # ARN of your ACM certificate (if enable_https = true)

# =============================================================================
# Application Secrets (Optional)
# For production, use AWS Secrets Manager instead of variables
# =============================================================================

# anthropic_api_key  = ""  # Anthropic API key
# openai_api_key     = ""  # OpenAI API key
# replicate_api_key  = ""  # Replicate API key
# elevenlabs_api_key = ""  # ElevenLabs API key
# gemini_api_key     = ""  # Google Gemini API key
# redis_url          = ""  # Redis connection URL
# database_url       = ""  # Database connection URL

# =============================================================================
# Cost Optimization Tips
# =============================================================================

# For Development/Testing (Lower Cost):
# ecs_task_cpu       = 512
# ecs_task_memory    = 1024
# ecs_min_capacity   = 1
# ecs_max_capacity   = 2
# log_retention_days = 3
# Estimated cost: ~$40-50/month

# For Production (Recommended):
# ecs_task_cpu       = 1024
# ecs_task_memory    = 2048
# ecs_min_capacity   = 1
# ecs_max_capacity   = 4
# log_retention_days = 7
# enable_deletion_protection = true
# Estimated cost: ~$97/month (minimal usage) to ~$200/month (high usage)

# For High Performance:
# ecs_task_cpu       = 2048
# ecs_task_memory    = 4096
# ecs_min_capacity   = 2
# ecs_max_capacity   = 8
# Estimated cost: ~$200-400/month

